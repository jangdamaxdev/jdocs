---
description: Tìm hiểu cách sắp xếp node bằng rete-auto-arrange-plugin. Hướng dẫn này cung cấp từng bước cài đặt plugin và các peer dependency cần thiết
keywords: layout,arrange,node position
---

# Arrange nodes

::alert
Hướng dẫn này dựa trên [Basic](/docs/guides/basic). Bạn nên xem qua để hiểu tổng thể trước khi đọc hướng dẫn này.
::
::references
:ref-example{title="Arrange" link="/examples/arrange"}
:ref-guide{title="Scopes" link="/docs/guides/scopes"}
:ref-github{title="Arrange plugin" link="https://github.com/retejs/auto-arrange-plugin"}
:ref-external{title="Elk.js" link="https://github.com/kieler/elkjs"}
::

:diagram{name="guides/arrange/index" caption="Kiến trúc"}

## Cài đặt dependencies {#install-dependencies}

:kit

Trước khi sử dụng plugin này, cần cài đặt peer dependency `elkjs` riêng biệt.

```bash
npm i rete-auto-arrange-plugin elkjs
```

Ngoài ra, có thể cần cài thêm `web-worker` nếu bundler của bạn không nhận diện dependency này mặc định

```bash
npm i web-worker
```

## Tạo node base {#create-node-base}

Cần chỉ định width và height cho node vì `elkjs` yêu cầu các giá trị này, đặc biệt khi kích thước node khác nhau.

```ts
class Node extends ClassicPreset.Node {
  width = 180;
  height = 120;
}

class Connection<N extends Node> extends ClassicPreset.Connection<N, N> {}

type Schemes = GetSchemes<Node, Connection<Node>>;
```

## Kết nối plugin {#connect-plugin}

```ts
import {
  AutoArrangePlugin,
  Presets as ArrangePresets,
} from "rete-auto-arrange-plugin";

const arrange = new AutoArrangePlugin<Schemes>();

arrange.addPreset(ArrangePresets.classic.setup());

area.use(arrange);
```

## Sắp xếp các node đã thêm {#arrange}

```ts
await arrange.layout();
```

## Sắp xếp node lồng nhau {#nested-nodes}

Bất kỳ node nào có thuộc tính `parent` sẽ được coi là node lồng trong node cha tương ứng, dựa vào id chỉ định trong trường này. Không cần thiết lập thêm. Hướng dẫn [Scopes](/docs/guides/scopes) có ví dụ thực tế về cách sử dụng.

## Sắp xếp có hiệu ứng động {#animated}

Nếu muốn chuyển động mượt mà khi thay đổi vị trí node, bạn có thể áp dụng `TransitionApplier` với thời gian và hàm timing tùy chỉnh

```ts
import { ArrangeAppliers } from "rete-auto-arrange-plugin";

const applier = new ArrangeAppliers.TransitionApplier<Schemes, AreaExtra>({
  duration: 500,
  timingFunction: (t) => t,
  async onTick() {
    // gọi mỗi lần cập nhật frame
  },
});

await arrange.layout({ applier });
```

## Tuỳ chọn sắp xếp

Bạn cũng có thể sử dụng [global options cho elk.js](https://eclipse.dev/elk/reference/options.html). Ví dụ, có thể thay đổi khoảng cách giữa các node

```ts
await arrange.layout({
  options: {
    "elk.spacing.nodeNode": 100,
    "elk.layered.spacing.nodeNodeBetweenLayers": 100,
  },
});
```

Xem kết quả hoàn chỉnh tại ví dụ [Arrange](/examples/arrange).
